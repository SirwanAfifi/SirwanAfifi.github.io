<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">

<head>

  <!-- Begin Jekyll SEO tag v2.3.0 -->
<title>Home | Sirwan Afifi</title>
<meta property="og:title" content="Home" />
<meta name="author" content="Sirwan Afifi" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Stories from a web developer." />
<meta property="og:description" content="Stories from a web developer." />
<link rel="canonical" href="http://localhost:4000/page/2/" />
<meta property="og:url" content="http://localhost:4000/page/2/" />
<meta property="og:site_name" content="Sirwan Afifi" />
<link rel="prev" href="http://localhost:4000/">
<link rel="next" href="http://localhost:4000/page/3">
<script type="application/ld+json">
{"name":null,"description":"Stories from a web developer.","author":{"@type":"Person","name":"Sirwan Afifi"},"@type":"WebPage","url":"http://localhost:4000/page/2/","publisher":null,"image":null,"headline":"Home","dateModified":null,"datePublished":null,"sameAs":null,"mainEntityOfPage":null,"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

  <link rel="canonical" href="http://sirwan.info/page/2/" />
  <title>
    Home &middot;  
  </title>

  <!-- CSS -->
  <link rel="stylesheet" href="/public/css/hyde.css">
  <link rel="stylesheet" href="/public/css/syntax.css">
  <link href='https://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css'>

  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/public/touch-icon-144-precomposed.png">
  <link rel="shortcut icon" href="/public/favicon.png">

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">

  <!-- Font Awesome -->
  <link rel="stylesheet" href="/css/font-awesome.min.css">
</head>


<body class="theme-base-0d">

  <header class="masthead">
    <div class="masthead-inner">
      <div class="profilepic">
        <a href="http://localhost:4000"><img src="/public/avatar.png" alt="Profile Picture"></a>
      </div>
      <h2>Sirwan Afifi</h2>
      <p class="lead">Stories from a web developer.</p>

      <div class="colophon">
        <ul class="colophon-links">
          <li>
            <a href="/about">about</a>
          </li>
          <li>
            <a href="/archive">archives</a>
          </li>
          <li>
            <a href="#">contact</a>
          </li>
        </ul>
        <p>&copy; 2018. Sirwan Afifi All rights reserved.</p>
      </div>
    </div>
  </header>

  <div class="content container">
    <div class="posts">
  
  <div class="post">
    <h1 class="post-title">
      <a href="/archive/2018/06/04/Uploading-file-in-Vue.js/">
        Uploading file in Vue.js
      </a>
    </h1>

    <span class="post-date">04 Jun 2018</span>

    <p>In this blog post I am going to show you how you can upload file using Vue.js. On the backend we will use ASP.NET Core MVC to expose an endpoint to the client to receive file. Let’s say we have a HTML form for saving a coffee, this form contains a file input to accept coffee’s image:</p>

<p><img src="/public/img/vue-upload-file.png" alt="Vue Upload File" width="750" /></p>

<p>To allow the user to pick a file we need to have a reference to the file input field using <code class="highlighter-rouge">ref</code> attribute then we can easily access this input using <code class="highlighter-rouge">$refs</code> object inside our Vue instance this is like selecting an element using jQuery:</p>

<figure class="highlight"><pre><code class="language-html" data-lang="html"><span class="nt">&lt;input</span> <span class="na">required</span> <span class="na">type=</span><span class="s">"file"</span> <span class="na">ref=</span><span class="s">"image"</span><span class="nt">&gt;</span></code></pre></figure>

<p>As you can see we named this input <code class="highlighter-rouge">image</code> so we can access the element this way:</p>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><span class="k">this</span><span class="p">.</span><span class="nx">$refs</span><span class="p">.</span><span class="nx">image</span></code></pre></figure>

<p>Before we can submit the form we can encapsulate functionality inside a service:</p>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><span class="k">import</span> <span class="nx">axios</span> <span class="k">from</span> <span class="s1">'axios'</span><span class="p">;</span>

<span class="kd">class</span> <span class="nx">CoffeeService</span> <span class="p">{</span>

    <span class="nx">saveCoffee</span><span class="p">(</span><span class="nx">coffee</span><span class="p">:</span> <span class="nx">any</span><span class="p">,</span> <span class="nx">file</span><span class="p">:</span> <span class="nx">any</span><span class="p">):</span> <span class="nx">any</span> <span class="p">{</span>
        <span class="kd">const</span> <span class="nx">formData</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">FormData</span><span class="p">();</span>
        <span class="k">for</span> <span class="p">(</span><span class="kd">const</span> <span class="nx">key</span> <span class="k">in</span> <span class="nx">coffee</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">coffee</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span><span class="nx">key</span><span class="p">))</span> <span class="p">{</span>
                <span class="nx">formData</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="nx">key</span><span class="p">,</span> <span class="nx">coffee</span><span class="p">[</span><span class="nx">key</span><span class="p">]);</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="nx">formData</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="nx">file</span><span class="p">.</span><span class="nx">name</span><span class="p">,</span> <span class="nx">file</span><span class="p">);</span>

        <span class="k">return</span> <span class="nx">axios</span><span class="p">.</span><span class="nx">post</span><span class="p">(</span><span class="s1">'/Coffees/SaveCoffee'</span><span class="p">,</span> <span class="nx">formData</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// Export a singletone instance in the global namespace</span>
<span class="k">export</span> <span class="kd">const</span> <span class="nx">coffeeService</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">CoffeeService</span><span class="p">();</span></code></pre></figure>

<p>This service has a method called <code class="highlighter-rouge">saveCoffee</code> which accepts two parameters one is the coffee itself and the second one is uploaded file then we are using <code class="highlighter-rouge">FormData</code> to combine these data together and sending it to the server using <code class="highlighter-rouge">axios</code> library. Keep in mind, this method returns a promise which means that the caller can use <code class="highlighter-rouge">then</code> syntax to get server’s response. So inside the <code class="highlighter-rouge">CoffeeComponent</code> we can use <code class="highlighter-rouge">Coffeeservice</code> like this:</p>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><span class="o">&lt;</span><span class="nx">template</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="nx">div</span> <span class="kd">class</span><span class="o">=</span><span class="s2">"container"</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="nx">h3</span><span class="o">&gt;</span><span class="nx">Add</span> <span class="nx">a</span> <span class="k">new</span> <span class="nx">Coffee</span><span class="o">&lt;</span><span class="sr">/h3</span><span class="err">&gt;
</span>        <span class="o">&lt;</span><span class="nx">form</span> <span class="nx">v</span><span class="o">-</span><span class="nx">on</span><span class="p">:</span><span class="nx">submit</span><span class="p">.</span><span class="nx">prevent</span><span class="o">=</span><span class="s2">"submitted"</span><span class="o">&gt;</span>
            <span class="o">&lt;</span><span class="nx">div</span> <span class="kd">class</span><span class="o">=</span><span class="s2">"form-group"</span><span class="o">&gt;</span>
                <span class="o">&lt;</span><span class="nx">label</span> <span class="kd">class</span><span class="o">=</span><span class="s2">"control-label"</span><span class="o">&gt;</span><span class="nx">Coffee</span> <span class="nx">Name</span><span class="o">&lt;</span><span class="sr">/label</span><span class="err">&gt;
</span>                <span class="o">&lt;</span><span class="nx">input</span> <span class="nx">required</span> <span class="nx">type</span><span class="o">=</span><span class="s2">"text"</span> <span class="kd">class</span><span class="o">=</span><span class="s2">"form-control"</span> <span class="nx">name</span><span class="o">=</span><span class="s2">"Name"</span> <span class="nx">v</span><span class="o">-</span><span class="nx">model</span><span class="o">=</span><span class="s2">"model.name"</span><span class="o">&gt;</span>
            <span class="o">&lt;</span><span class="sr">/div</span><span class="err">&gt;
</span>
            <span class="o">&lt;</span><span class="nx">div</span> <span class="kd">class</span><span class="o">=</span><span class="s2">"form-group"</span><span class="o">&gt;</span>
                <span class="o">&lt;</span><span class="nx">label</span> <span class="kd">class</span><span class="o">=</span><span class="s2">"control-label"</span><span class="o">&gt;</span><span class="nx">Coffee</span> <span class="nx">Type</span><span class="o">&lt;</span><span class="sr">/label</span><span class="err">&gt;
</span>                <span class="o">&lt;</span><span class="nx">select</span> <span class="kd">class</span><span class="o">=</span><span class="s2">"form-control"</span> <span class="nx">name</span><span class="o">=</span><span class="s2">"CoffeeType"</span> <span class="nx">v</span><span class="o">-</span><span class="nx">model</span><span class="o">=</span><span class="s2">"model.coffeeType"</span><span class="o">&gt;</span>
                    <span class="o">&lt;</span><span class="nx">option</span> <span class="nx">v</span><span class="o">-</span><span class="k">for</span><span class="o">=</span><span class="s2">"coffeeType in coffeeTypes"</span> <span class="p">:</span><span class="nx">value</span><span class="o">=</span><span class="s2">"coffeeType.value"</span> <span class="nx">v</span><span class="o">-</span><span class="nx">bind</span><span class="p">:</span><span class="nx">key</span><span class="o">=</span><span class="s2">"coffeeType.value"</span><span class="o">&gt;&lt;</span><span class="sr">/option</span><span class="err">&gt;
</span>                <span class="o">&lt;</span><span class="sr">/select</span><span class="err">&gt;
</span>            <span class="o">&lt;</span><span class="sr">/div</span><span class="err">&gt;
</span>
            <span class="o">&lt;</span><span class="nx">div</span> <span class="kd">class</span><span class="o">=</span><span class="s2">"form-group"</span><span class="o">&gt;</span>
                <span class="o">&lt;</span><span class="nx">label</span> <span class="kd">class</span><span class="o">=</span><span class="s2">"control-label"</span><span class="o">&gt;</span><span class="nx">Coffee</span> <span class="nx">Image</span><span class="o">&lt;</span><span class="sr">/label</span><span class="err">&gt;
</span>                <span class="o">&lt;</span><span class="nx">input</span> <span class="nx">required</span> <span class="nx">type</span><span class="o">=</span><span class="s2">"file"</span> <span class="nx">multiple</span> <span class="kd">class</span><span class="o">=</span><span class="s2">"form-control"</span> <span class="nx">name</span><span class="o">=</span><span class="s2">"Image"</span> <span class="p">@</span><span class="nd">change</span><span class="o">=</span><span class="s2">"fileChange"</span> <span class="nx">ref</span><span class="o">=</span><span class="s2">"image"</span><span class="o">&gt;</span>
            <span class="o">&lt;</span><span class="sr">/div</span><span class="err">&gt;
</span>
            <span class="o">&lt;</span><span class="nx">button</span> <span class="kd">class</span><span class="o">=</span><span class="s2">"btn btn-primary"</span> <span class="nx">type</span><span class="o">=</span><span class="s2">"submit"</span><span class="o">&gt;</span><span class="nx">Save</span><span class="o">&lt;</span><span class="sr">/button</span><span class="err">&gt;
</span>        <span class="o">&lt;</span><span class="sr">/form</span><span class="err">&gt;
</span>    <span class="o">&lt;</span><span class="sr">/div</span><span class="err">&gt;
</span><span class="o">&lt;</span><span class="sr">/template</span><span class="err">&gt;
</span>
<span class="o">&lt;</span><span class="nx">script</span> <span class="nx">lang</span><span class="o">=</span><span class="s2">"ts"</span><span class="o">&gt;</span>
<span class="k">import</span> <span class="nx">Vue</span> <span class="k">from</span> <span class="s2">"vue"</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">Component</span><span class="p">,</span> <span class="nx">Prop</span><span class="p">,</span> <span class="nx">Watch</span> <span class="p">}</span> <span class="k">from</span> <span class="s2">"vue-property-decorator"</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">coffeeService</span> <span class="p">}</span> <span class="k">from</span> <span class="s2">"../services/CoffeeService"</span><span class="p">;</span>
<span class="c1">/// &lt;reference path="./toaster.d.ts" /&gt;</span>

<span class="p">@</span><span class="nd">Component</span><span class="p">({</span>
  <span class="na">components</span><span class="p">:</span> <span class="p">{</span> <span class="nx">UploadFileSimpleComponent</span> <span class="p">}</span>
<span class="p">})</span>
<span class="k">export</span> <span class="k">default</span> <span class="kd">class</span> <span class="nx">UploadFileSimpleComponent</span> <span class="kd">extends</span> <span class="nx">Vue</span> <span class="p">{</span>
  <span class="nx">coffeeTypes</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span> <span class="na">name</span><span class="p">:</span> <span class="s2">"Espresso"</span><span class="p">,</span> <span class="na">value</span><span class="p">:</span> <span class="mi">0</span> <span class="p">},</span>
    <span class="p">{</span> <span class="na">name</span><span class="p">:</span> <span class="s2">"Latte"</span><span class="p">,</span> <span class="na">value</span><span class="p">:</span> <span class="mi">1</span> <span class="p">},</span>
    <span class="p">{</span> <span class="na">name</span><span class="p">:</span> <span class="s2">"Mocha"</span><span class="p">,</span> <span class="na">value</span><span class="p">:</span> <span class="mi">2</span> <span class="p">}</span>
  <span class="p">];</span>

  <span class="nx">model</span> <span class="o">=</span> <span class="p">{};</span>

  <span class="nx">submitted</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">coffeeService</span>
      <span class="p">.</span><span class="nx">saveCoffee</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">model</span><span class="p">,</span> <span class="p">(</span><span class="o">&lt;</span><span class="nx">any</span><span class="o">&gt;</span><span class="k">this</span><span class="p">.</span><span class="nx">$refs</span><span class="p">.</span><span class="nx">image</span><span class="p">).</span><span class="nx">files</span><span class="p">)</span>
      <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="na">response</span><span class="p">:</span> <span class="nx">any</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">toastr</span><span class="p">.</span><span class="nx">success</span><span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">data</span><span class="p">);</span>
      <span class="p">})</span>
      <span class="p">.</span><span class="k">catch</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="na">error</span><span class="p">:</span> <span class="nx">any</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">toastr</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="nx">error</span><span class="p">);</span>
      <span class="p">});</span>
  <span class="p">}</span>
<span class="p">}</span>
<span class="o">&lt;</span><span class="sr">/script&gt;</span></code></pre></figure>

<h3 id="showing-upload-progress">Showing upload progress</h3>
<p>Now we want to show upload progress, axios makes this easy all we need to do is add a third argument to the <code class="highlighter-rouge">post</code> method, this argument is actually an object, inside this object we can configure the request inside this object we have access to an event handler called <code class="highlighter-rouge">onUploadProgress</code> which we can do the calculation. let’s change the <code class="highlighter-rouge">CoffeeService</code> to this:</p>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><span class="k">import</span> <span class="nx">axios</span> <span class="k">from</span> <span class="s1">'axios'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">eventBus</span> <span class="p">}</span> <span class="k">from</span> <span class="s1">'../main'</span><span class="p">;</span>

<span class="kd">class</span> <span class="nx">CoffeeService</span> <span class="p">{</span>

    <span class="nx">saveCoffee</span><span class="p">(</span><span class="nx">coffee</span><span class="p">:</span> <span class="nx">any</span><span class="p">,</span> <span class="nx">file</span><span class="p">:</span> <span class="nx">any</span><span class="p">):</span> <span class="nx">any</span> <span class="p">{</span>
        <span class="kd">const</span> <span class="nx">formData</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">FormData</span><span class="p">();</span>
        <span class="k">for</span> <span class="p">(</span><span class="kd">const</span> <span class="nx">key</span> <span class="k">in</span> <span class="nx">coffee</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">coffee</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span><span class="nx">key</span><span class="p">))</span> <span class="p">{</span>
                <span class="nx">formData</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="nx">key</span><span class="p">,</span> <span class="nx">coffee</span><span class="p">[</span><span class="nx">key</span><span class="p">]);</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="nx">formData</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="nx">file</span><span class="p">.</span><span class="nx">name</span><span class="p">,</span> <span class="nx">file</span><span class="p">);</span>

        <span class="kd">let</span> <span class="nx">startTime</span> <span class="o">=</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">();</span>

        <span class="k">return</span> <span class="nx">axios</span><span class="p">.</span><span class="nx">post</span><span class="p">(</span><span class="s1">'/Coffees/SaveCoffee'</span><span class="p">,</span> <span class="nx">formData</span><span class="p">,</span> <span class="p">{</span>
            <span class="na">onUploadProgress</span><span class="p">:</span> <span class="nx">uploadEvent</span> <span class="o">=&gt;</span> <span class="p">{</span>
                <span class="kd">const</span> <span class="nx">queueProgress</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">round</span><span class="p">(</span><span class="nx">uploadEvent</span><span class="p">.</span><span class="nx">loaded</span> <span class="o">/</span> <span class="nx">uploadEvent</span><span class="p">.</span><span class="nx">total</span> <span class="o">*</span> <span class="mi">100</span><span class="p">);</span>
                <span class="kd">const</span> <span class="nx">timeElapsed</span> <span class="o">=</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">()</span> <span class="o">-</span> <span class="nx">startTime</span><span class="p">;</span>
                <span class="kd">const</span> <span class="nx">uploadSpeedFirst</span> <span class="o">=</span> <span class="nx">uploadEvent</span><span class="p">.</span><span class="nx">loaded</span> <span class="o">/</span> <span class="p">(</span><span class="nx">timeElapsed</span> <span class="o">/</span> <span class="mi">1000</span><span class="p">);</span>
                <span class="kd">const</span> <span class="nx">uploadTimeRemaining</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">ceil</span><span class="p">(</span>
                    <span class="p">(</span><span class="nx">uploadEvent</span><span class="p">.</span><span class="nx">total</span> <span class="o">-</span> <span class="nx">uploadEvent</span><span class="p">.</span><span class="nx">loaded</span><span class="p">)</span> <span class="o">/</span> <span class="nx">uploadSpeedFirst</span>
                  <span class="p">);</span>
                <span class="kd">const</span> <span class="nx">uploadTimeElapsed</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">ceil</span><span class="p">(</span><span class="nx">timeElapsed</span> <span class="o">/</span> <span class="mi">1000</span><span class="p">);</span>
                <span class="kd">const</span> <span class="nx">uploadSpeed</span> <span class="o">=</span> <span class="nx">uploadSpeedFirst</span> <span class="o">/</span> <span class="mi">1024</span> <span class="o">/</span> <span class="mi">1024</span><span class="p">;</span>

                <span class="nx">eventBus</span><span class="p">.</span><span class="nx">$emit</span><span class="p">(</span><span class="s1">'uploadData'</span><span class="p">,</span> <span class="p">{</span>
                    <span class="nx">queueProgress</span><span class="p">,</span>
                    <span class="nx">uploadTimeRemaining</span><span class="p">,</span>
                    <span class="nx">uploadTimeElapsed</span><span class="p">,</span>
                    <span class="nx">uploadSpeed</span>
                <span class="p">});</span>
            <span class="p">}</span>
        <span class="p">});</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// Export a singletone instance in the global namespace</span>
<span class="k">export</span> <span class="kd">const</span> <span class="nx">coffeeService</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">CoffeeService</span><span class="p">();</span></code></pre></figure>

<p>Inside the method we construct an object, this object will notify all subscribers with current progress. This notification is done using <code class="highlighter-rouge">$emit</code> method. We also need to update the template to show this progress:</p>

<figure class="highlight"><pre><code class="language-html" data-lang="html"><span class="nt">&lt;div</span> <span class="na">v-if=</span><span class="s">"uploadDetails.queueProgress &gt; 0"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;table</span> <span class="na">class=</span><span class="s">"table"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;thead&gt;</span>
        <span class="nt">&lt;tr&gt;</span>
            <span class="nt">&lt;th</span> <span class="na">width=</span><span class="s">"15%"</span><span class="nt">&gt;</span>Event<span class="nt">&lt;/th&gt;</span>
            <span class="nt">&lt;th&gt;</span>Status<span class="nt">&lt;/th&gt;</span>
        <span class="nt">&lt;/tr&gt;</span>
        <span class="nt">&lt;/thead&gt;</span>
        <span class="nt">&lt;tbody&gt;</span>
        <span class="nt">&lt;tr&gt;</span>
            <span class="nt">&lt;td&gt;&lt;strong&gt;</span>Elapsed time<span class="nt">&lt;/strong&gt;&lt;/td&gt;</span>
            <span class="nt">&lt;td</span> <span class="na">nowrap</span><span class="nt">&gt;</span> second(s)<span class="nt">&lt;/td&gt;</span>
        <span class="nt">&lt;/tr&gt;</span>
        <span class="nt">&lt;tr&gt;</span>
            <span class="nt">&lt;td&gt;&lt;strong&gt;</span>Remaining time<span class="nt">&lt;/strong&gt;&lt;/td&gt;</span>
            <span class="nt">&lt;td</span> <span class="na">nowrap</span><span class="nt">&gt;</span> second(s)<span class="nt">&lt;/td&gt;</span>
        <span class="nt">&lt;/tr&gt;</span>
        <span class="nt">&lt;tr&gt;</span>
            <span class="nt">&lt;td&gt;&lt;strong&gt;</span>Upload speed<span class="nt">&lt;/strong&gt;&lt;/td&gt;</span>
            <span class="nt">&lt;td</span> <span class="na">nowrap</span><span class="nt">&gt;</span> MB/s<span class="nt">&lt;/td&gt;</span>
        <span class="nt">&lt;/tr&gt;</span>
        <span class="nt">&lt;tr&gt;</span>
            <span class="nt">&lt;td&gt;&lt;strong&gt;</span>Queue progress<span class="nt">&lt;/strong&gt;&lt;/td&gt;</span>
            <span class="nt">&lt;td&gt;</span>
            <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"progress-bar progress-bar-info progress-bar-striped"</span> <span class="na">role=</span><span class="s">"progressbar"</span>
                <span class="na">aria-valuemin=</span><span class="s">"0"</span> <span class="na">aria-valuemax=</span><span class="s">"100"</span> <span class="na">:aria-valuenow=</span><span class="s">"uploadDetails.queueProgress"</span>
                <span class="na">:style=</span><span class="s">"{ 'width': uploadDetails.queueProgress + '%' }"</span><span class="nt">&gt;</span>
                %
            <span class="nt">&lt;/div&gt;</span>
            <span class="nt">&lt;/td&gt;</span>
        <span class="nt">&lt;/tr&gt;</span>
        <span class="nt">&lt;/tbody&gt;</span>
    <span class="nt">&lt;/table&gt;</span>
<span class="nt">&lt;/div&gt;</span></code></pre></figure>

<p>The backend is a simple MVC controller, all it does is uploading the file and saving the coffee into the database:</p>

<figure class="highlight"><pre><code class="language-csharp" data-lang="csharp"><span class="k">public</span> <span class="k">async</span> <span class="n">Task</span><span class="p">&lt;</span><span class="n">IActionResult</span><span class="p">&gt;</span> <span class="nf">SaveCoffee</span><span class="p">(</span><span class="n">Coffee</span> <span class="n">coffee</span><span class="p">)</span>
<span class="p">{</span>
    <span class="c1">// Uploading files</span>
    <span class="kt">var</span> <span class="n">fileName</span> <span class="p">=</span> <span class="k">await</span> <span class="nf">UploadFiles</span><span class="p">();</span>

    <span class="c1">// Saving data</span>
    <span class="n">coffee</span><span class="p">.</span><span class="n">Image</span> <span class="p">=</span> <span class="n">fileName</span><span class="p">;</span>
    <span class="n">_coffeeService</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="n">coffee</span><span class="p">);</span>
    <span class="n">_coffeeService</span><span class="p">.</span><span class="nf">SaveChanges</span><span class="p">();</span>

    <span class="k">return</span> <span class="nf">Json</span><span class="p">(</span><span class="s">"Coffee has been saved!"</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">private</span> <span class="k">async</span> <span class="n">Task</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;</span> <span class="nf">UploadFiles</span><span class="p">()</span>
<span class="p">{</span>
    <span class="kt">var</span> <span class="n">uploadsRootFolder</span> <span class="p">=</span> <span class="n">Path</span><span class="p">.</span><span class="nf">Combine</span><span class="p">(</span><span class="n">_environment</span><span class="p">.</span><span class="n">WebRootPath</span><span class="p">,</span> <span class="s">"uploads"</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(!</span><span class="n">Directory</span><span class="p">.</span><span class="nf">Exists</span><span class="p">(</span><span class="n">uploadsRootFolder</span><span class="p">))</span>
    <span class="p">{</span>
        <span class="n">Directory</span><span class="p">.</span><span class="nf">CreateDirectory</span><span class="p">(</span><span class="n">uploadsRootFolder</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="kt">var</span> <span class="n">files</span> <span class="p">=</span> <span class="n">Request</span><span class="p">.</span><span class="n">Form</span><span class="p">.</span><span class="n">Files</span><span class="p">;</span>
    <span class="k">foreach</span> <span class="p">(</span><span class="kt">var</span> <span class="n">file</span> <span class="k">in</span> <span class="n">files</span><span class="p">)</span>

    <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">file</span> <span class="p">==</span> <span class="k">null</span> <span class="p">||</span> <span class="n">file</span><span class="p">.</span><span class="n">Length</span> <span class="p">==</span> <span class="m">0</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">continue</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="kt">var</span> <span class="n">filePath</span> <span class="p">=</span> <span class="n">Path</span><span class="p">.</span><span class="nf">Combine</span><span class="p">(</span><span class="n">uploadsRootFolder</span><span class="p">,</span> <span class="n">file</span><span class="p">.</span><span class="n">FileName</span><span class="p">);</span>
        <span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">fileStream</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">FileStream</span><span class="p">(</span><span class="n">filePath</span><span class="p">,</span> <span class="n">FileMode</span><span class="p">.</span><span class="n">Create</span><span class="p">))</span>
        <span class="p">{</span>
            <span class="k">await</span> <span class="n">file</span><span class="p">.</span><span class="nf">CopyToAsync</span><span class="p">(</span><span class="n">fileStream</span><span class="p">).</span><span class="nf">ConfigureAwait</span><span class="p">(</span><span class="k">false</span><span class="p">);</span>
            <span class="k">return</span> <span class="n">file</span><span class="p">.</span><span class="n">FileName</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="kt">string</span><span class="p">.</span><span class="n">Empty</span><span class="p">;</span>
<span class="p">}</span></code></pre></figure>

<p><img src="/public/img/upload-file-vue.gif" alt="Upload file using Vue.js" width="700" /></p>

<p>You can grab the working sample project from <a href="https://github.com/SirwanAfifi/vue-experiments">GitHub</a>.</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/archive/2018/05/28/TypeScript-and-Vue.js/">
        TypeScript and Vue.js
      </a>
    </h1>

    <span class="post-date">28 May 2018</span>

    <p><img src="/public/img/vuepost.png" alt="Webpack" width="750" /></p>

<p>You might be wondering why do we need to worry about yet another framework when we already know there are things like Angular, React, … the answer is simplicity. I have used Angular in some of my previous projects by Angular I mean the first version of it (AngularJS 1.x) but these days I feel like Angular team is going to force developers to migrate to Angular (2, 3, 4, 5, 6, …). I really like Vue.js, it’s really a great one because I think Vue.js is Declarative, Easy to Maintain and Powerful.
Also, the integration between Vue and TypeScript is really good. Just like other frameworks Vue also has CLI which helps you to scaffold your project quickly. In this blog post, I would like to show how to combine Vue.js with TypeScript inside an ASP.NET Core 2.x application.</p>

<h3 id="project-setup">Project Setup</h3>
<p>The easiest way to get started is by using dotnet cli tool to create a project:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">dotnet new mvc <span class="nt">--name</span> aspnet-vue-typescript</code></pre></figure>

<p>Then cd to that directory and then use <code class="highlighter-rouge">code .</code> to open VSCode. At this point the project structure looks like this:</p>

<p><img src="/public/img/dotnet-new.png" alt="Sample app" width="700" /></p>

<p>To get started with our client side code we need to install some packages, for doing so we need <code class="highlighter-rouge">package.json</code> file:</p>

<figure class="highlight"><pre><code class="language-json" data-lang="json"><span class="p">{</span><span class="w">
  </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"aspnet-vue-typescript"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"version"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1.0.0"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
  </span><span class="s2">"main"</span><span class="p">:</span><span class="w"> </span><span class="s2">"index.js"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"scripts"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"test"</span><span class="p">:</span><span class="w"> </span><span class="s2">"echo </span><span class="se">\"</span><span class="s2">Error: no test specified</span><span class="se">\"</span><span class="s2"> &amp;&amp; exit 1"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="s2">"author"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Sirwan Afifi"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"license"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ISC"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"dependencies"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"ts-loader"</span><span class="p">:</span><span class="w"> </span><span class="s2">"^4.3.0"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"typescript"</span><span class="p">:</span><span class="w"> </span><span class="s2">"^2.8.3"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"vue"</span><span class="p">:</span><span class="w"> </span><span class="s2">"^2.5.16"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"vue-class-component"</span><span class="p">:</span><span class="w"> </span><span class="s2">"^6.2.0"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"vue-property-decorator"</span><span class="p">:</span><span class="w"> </span><span class="s2">"^6.1.0"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"webpack"</span><span class="p">:</span><span class="w"> </span><span class="s2">"^4.9.1"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"webpack-dev-server"</span><span class="p">:</span><span class="w"> </span><span class="s2">"^3.1.4"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="s2">"devDependencies"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"aspnet-webpack"</span><span class="p">:</span><span class="w"> </span><span class="s2">"^2.0.3"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"css-loader"</span><span class="p">:</span><span class="w"> </span><span class="s2">"^0.28.11"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"file-loader"</span><span class="p">:</span><span class="w"> </span><span class="s2">"^1.1.11"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"sass-loader"</span><span class="p">:</span><span class="w"> </span><span class="s2">"^7.0.1"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"style-loader"</span><span class="p">:</span><span class="w"> </span><span class="s2">"^0.21.0"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"vue-loader"</span><span class="p">:</span><span class="w"> </span><span class="s2">"^15.2.1"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"vue-template-compiler"</span><span class="p">:</span><span class="w"> </span><span class="s2">"^2.5.16"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"webpack-cli"</span><span class="p">:</span><span class="w"> </span><span class="s2">"^2.1.4"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"webpack-hot-middleware"</span><span class="p">:</span><span class="w"> </span><span class="s2">"^2.22.2"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span></code></pre></figure>

<p>Once you installed this packages using <code class="highlighter-rouge">npm install</code>, we’ll create our <code class="highlighter-rouge">webpack.config.js</code> file:</p>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><span class="kd">let</span> <span class="nx">webpack</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'webpack'</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">VueLoaderPlugin</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'vue-loader/lib/plugin'</span><span class="p">);</span>
<span class="kd">let</span> <span class="nx">path</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'path'</span><span class="p">);</span>

<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">entry</span><span class="p">:</span> <span class="p">{</span>
        <span class="na">main</span><span class="p">:</span> <span class="s1">'./ClientApp/main'</span>
    <span class="p">},</span>
    <span class="na">output</span><span class="p">:</span> <span class="p">{</span>
        <span class="na">path</span><span class="p">:</span> <span class="nx">path</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="nx">__dirname</span><span class="p">,</span> <span class="s1">'wwwroot'</span><span class="p">,</span> <span class="s1">'js'</span><span class="p">),</span>
        <span class="na">filename</span><span class="p">:</span> <span class="s1">'[name].js'</span><span class="p">,</span>
        <span class="na">publicPath</span><span class="p">:</span> <span class="s1">'/js/'</span>
    <span class="p">},</span>
    <span class="na">module</span><span class="p">:</span> <span class="p">{</span>
        <span class="na">rules</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span> <span class="na">test</span><span class="p">:</span> <span class="sr">/</span><span class="se">\.</span><span class="sr">vue$/</span><span class="p">,</span> <span class="na">loader</span><span class="p">:</span> <span class="s2">"vue-loader"</span> <span class="p">},</span>
            <span class="p">{</span>
                <span class="na">test</span><span class="p">:</span> <span class="sr">/</span><span class="se">\.</span><span class="sr">tsx</span><span class="se">?</span><span class="sr">$/</span><span class="p">,</span>
                <span class="na">loader</span><span class="p">:</span> <span class="s1">'ts-loader'</span><span class="p">,</span>
                <span class="na">exclude</span><span class="p">:</span> <span class="sr">/node_modules/</span><span class="p">,</span>
                <span class="na">options</span><span class="p">:</span> <span class="p">{</span> <span class="na">appendTsSuffixTo</span><span class="p">:</span> <span class="p">[</span><span class="sr">/</span><span class="se">\.</span><span class="sr">vue$/</span><span class="p">]</span> <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">]</span>
    <span class="p">},</span>
    <span class="na">resolve</span><span class="p">:</span> <span class="p">{</span>
        <span class="na">extensions</span><span class="p">:</span> <span class="p">[</span><span class="s1">'.tsx'</span><span class="p">,</span> <span class="s1">'.ts'</span><span class="p">,</span> <span class="s1">'.js'</span><span class="p">],</span>
        <span class="na">alias</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">'vue$'</span><span class="p">:</span> <span class="s1">'vue/dist/vue.esm.js'</span> <span class="c1">// 'vue/dist/vue.common.js' for webpack 1</span>
        <span class="p">}</span>
    <span class="p">},</span>
    <span class="na">optimization</span><span class="p">:</span> <span class="p">{</span>
        <span class="na">splitChunks</span><span class="p">:</span> <span class="p">{</span>
            <span class="na">cacheGroups</span><span class="p">:</span> <span class="p">{</span>
                <span class="na">commons</span><span class="p">:</span> <span class="p">{</span>
                    <span class="na">test</span><span class="p">:</span> <span class="sr">/</span><span class="se">[\\/]</span><span class="sr">node_modules</span><span class="se">[\\/]</span><span class="sr">/</span><span class="p">,</span>
                    <span class="na">name</span><span class="p">:</span> <span class="s2">"main"</span><span class="p">,</span>
                    <span class="na">chunks</span><span class="p">:</span> <span class="s2">"all"</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">},</span>
    <span class="na">plugins</span><span class="p">:</span> <span class="p">[</span>
        <span class="k">new</span> <span class="nx">VueLoaderPlugin</span><span class="p">()</span>
    <span class="p">]</span>
<span class="p">};</span></code></pre></figure>

<p>As you can see we’re telling webpack where the entry point is, so create a new directory inside the project called <code class="highlighter-rouge">ClientApp</code>, this directory contains all Vue’s related files, Inside this directory, create a ts file called <code class="highlighter-rouge">main.ts</code> this file is going to be our entry point:</p>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><span class="k">import</span> <span class="nx">Vue</span> <span class="k">from</span> <span class="s1">'vue'</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">MyComponent</span> <span class="k">from</span> <span class="s1">'./components/MyComponent.vue'</span><span class="p">;</span>


<span class="nx">Vue</span><span class="p">.</span><span class="nx">config</span><span class="p">.</span><span class="nx">productionTip</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>

<span class="kd">const</span> <span class="nx">v</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Vue</span><span class="p">({</span>
    <span class="na">el</span><span class="p">:</span> <span class="s1">'#app'</span><span class="p">,</span>
    <span class="nx">data</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="na">name</span><span class="p">:</span> <span class="s1">'Sirwan'</span>
        <span class="p">}</span>
    <span class="p">},</span>
    <span class="na">components</span><span class="p">:</span> <span class="p">{</span>
        <span class="nx">MyComponent</span>
    <span class="p">}</span>
<span class="p">});</span></code></pre></figure>

<p>Next, we have specified the output which is <code class="highlighter-rouge">bundle.js</code> file, this file doesn’t yet exist, it’s going to be created by webpack. Then we have specified TypeScript loader for webpack. Next thing left to do is adding <code class="highlighter-rouge">tsconfig.json</code> file to the project:</p>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><span class="p">{</span>
    <span class="s2">"compilerOptions"</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">"sourceMap"</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
        <span class="s2">"noImplicitReturns"</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
        <span class="s2">"noImplicitAny"</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
        <span class="s2">"experimentalDecorators"</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
        <span class="s2">"emitDecoratorMetadata"</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
        <span class="s2">"target"</span><span class="p">:</span> <span class="s2">"es5"</span><span class="p">,</span>
        <span class="s2">"strict"</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
        <span class="s2">"module"</span><span class="p">:</span> <span class="s2">"es2015"</span><span class="p">,</span>
        <span class="s2">"moduleResolution"</span><span class="p">:</span> <span class="s2">"node"</span><span class="p">,</span>
        <span class="s2">"lib"</span><span class="p">:</span> <span class="p">[</span>
            <span class="s2">"es2016"</span><span class="p">,</span>
            <span class="s2">"dom"</span>
        <span class="p">]</span>
    <span class="p">},</span>
    <span class="s2">"exclude"</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">"node_modules"</span><span class="p">,</span>
        <span class="s2">"wwwroot"</span>
    <span class="p">]</span>
<span class="p">}</span></code></pre></figure>

<p>At this point if you run <code class="highlighter-rouge">npx webpack</code> you’ll see the bundle file:</p>

<p><img src="/public/img/npx-webpack.png" alt="Webpack" width="700" /></p>

<p>Now we can add a script reference inside <code class="highlighter-rouge">Views/Shared/_Layout.cshtml</code> to <code class="highlighter-rouge">bundle.js</code> file:</p>

<figure class="highlight"><pre><code class="language-html" data-lang="html"><span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"~/js/bundle.js"</span> <span class="na">asp-append-version=</span><span class="s">"true"</span><span class="nt">&gt;&lt;/script&gt;</span></code></pre></figure>

<p>Now we can use Vue inside our views:</p>

<figure class="highlight"><pre><code class="language-csharp" data-lang="csharp"><span class="err">@</span><span class="p">{</span>
    <span class="n">ViewData</span><span class="p">[</span><span class="s">"Title"</span><span class="p">]</span> <span class="p">=</span> <span class="s">"Home Page"</span><span class="p">;</span>
<span class="p">}</span>

<span class="p">&lt;</span><span class="n">div</span> <span class="k">class</span><span class="err">="</span><span class="nc">jumbotron</span><span class="s">"&gt;
</span>  <span class="p">&lt;</span><span class="n">h1</span> <span class="k">class</span><span class="err">="</span><span class="nc">display</span><span class="p">-</span><span class="m">4</span><span class="s">"&gt;Hello, &lt;/h1&gt;
</span><span class="p">&lt;/</span><span class="n">div</span><span class="p">&gt;</span></code></pre></figure>

<h3 id="hot-module-replacement">Hot Module Replacement</h3>
<p>Webpack has something called Hot <a href="https://webpack.js.org/concepts/hot-module-replacement/">Module Replacement</a>:</p>

<blockquote>
  <p>Hot Module Replacement (HMR) exchanges, adds, or removes modules while an application is running, without a full reload. This can significantly speed up development in a few ways:
Retain application state which is lost during a full reload.
Save valuable development time by only updating what’s changed.
Tweak styling faster – almost comparable to changing styles in the browser’s debugger.</p>
</blockquote>

<p>For adding this functionality we need to install <code class="highlighter-rouge">webpack-hot-middleware</code> package:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">npm i <span class="nt">-D</span> webpack-hot-middleware</code></pre></figure>

<p>Then we need to register this component into MVC’s HTTP request pipeline in the <code class="highlighter-rouge">Configure</code> method, for doing this we need to install <a href="https://www.nuget.org/packages/Microsoft.AspNetCore.SpaServices">Microsoft.AspNetCore.SpaServices</a>:</p>

<figure class="highlight"><pre><code class="language-csharp" data-lang="csharp"><span class="n">app</span><span class="p">.</span><span class="nf">UseWebpackDevMiddleware</span><span class="p">(</span><span class="k">new</span> <span class="n">WebpackDevMiddlewareOptions</span>
<span class="p">{</span>
    <span class="n">HotModuleReplacement</span> <span class="p">=</span> <span class="k">true</span>
<span class="p">});</span></code></pre></figure>

<p>This middleware looks for webpack file and automatically executes it for us when we change client side code:</p>

<p><img src="/public/img/reload-webpack.gif" alt="Webpack" width="700" /></p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/archive/2018/05/02/Developing-Console-based-UI-in-C/">
        Developing Console-based UI in C#
      </a>
    </h1>

    <span class="post-date">02 May 2018</span>

    <p>As you know Console Applications don’t have graphical user interface or GUI. Instead, they run from Command Line, for example instead of writing a name into a textbox and clicking a button we would instead invoke the Console Application and provide the name as a parameter. In fact, in Console Applications we instead interact with the user using text inputs. For example, we could prompt something like this:</p>

<p><img src="/public/img/consoleTest.jpg" width="700" /></p>

<p>The user can then write a name and hit enter then we can read that text input into our application.</p>

<p>Wouldn’t be better to make it beautiful? This is where we can use <a href="https://github.com/migueldeicaza/gui.cs">Terminal.Gui</a> a cross-platform GUI toolkit:</p>

<p><img src="/public/img/guics.png" alt="Sample app" width="700" /></p>

<blockquote>
  <p>Terminal.Gui is a library intended to create console-based applications using C#. The framework has been designed to make it easy to write applications that will work on monochrome terminals, as well as modern color terminals with mouse support. This library works across Windows, Linux and MacOS.</p>
</blockquote>

<p>Using this UI toolkit is pretty simple, all you need to do is adding its package into your project:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>dotnet add package Terminal.Gui
</code></pre></div></div>

<p>The simplest application looks like this:</p>

<figure class="highlight"><pre><code class="language-csharp" data-lang="csharp"><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">consoleTest</span>
<span class="p">{</span>
    <span class="k">using</span> <span class="nn">Terminal.Gui</span><span class="p">;</span>

    <span class="k">class</span> <span class="nc">Demo</span> <span class="p">{</span>
        <span class="k">static</span> <span class="kt">int</span> <span class="nf">Main</span> <span class="p">()</span>
        <span class="p">{</span>
            <span class="n">Application</span><span class="p">.</span><span class="nf">Init</span> <span class="p">();</span>

            <span class="kt">var</span> <span class="n">n</span> <span class="p">=</span> <span class="n">MessageBox</span><span class="p">.</span><span class="nf">Query</span> <span class="p">(</span><span class="m">50</span><span class="p">,</span> <span class="m">7</span><span class="p">,</span>
                <span class="s">"Question"</span><span class="p">,</span> <span class="s">"Do you like console apps?"</span><span class="p">,</span> <span class="s">"Yes"</span><span class="p">,</span> <span class="s">"No"</span><span class="p">);</span>

            <span class="k">return</span> <span class="n">n</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre></figure>

<p>This example shows a prompt and returns an integer value depending on which value was selected by the user (Yes, No, or if they use chose not to make a decision and instead pressed the ESC key):</p>

<p><img src="/public/img/firstTerminalUIapp.png" alt="Sample app" width="700" /></p>

<p>As you can see the first thing to do is calling <code class="highlighter-rouge">Application.Init ();</code> to actually initialize the application. We can also create a window and then add a menu to it:</p>

<figure class="highlight"><pre><code class="language-csharp" data-lang="csharp"><span class="n">Application</span><span class="p">.</span><span class="nf">Init</span> <span class="p">();</span>
<span class="kt">var</span> <span class="n">top</span> <span class="p">=</span> <span class="n">Application</span><span class="p">.</span><span class="n">Top</span><span class="p">;</span>

<span class="c1">// Creates the top-level window to show</span>
<span class="kt">var</span> <span class="n">win</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Window</span> <span class="p">(</span><span class="k">new</span> <span class="nf">Rect</span> <span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="n">top</span><span class="p">.</span><span class="n">Frame</span><span class="p">.</span><span class="n">Width</span><span class="p">,</span> <span class="n">top</span><span class="p">.</span><span class="n">Frame</span><span class="p">.</span><span class="n">Height</span><span class="p">-</span><span class="m">1</span><span class="p">),</span> <span class="s">"MyApp"</span><span class="p">);</span>
<span class="n">top</span><span class="p">.</span><span class="nf">Add</span> <span class="p">(</span><span class="n">win</span><span class="p">);</span>

<span class="c1">// Creates a menubar, the item "New" has a help menu.</span>
<span class="kt">var</span> <span class="n">menu</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">MenuBar</span> <span class="p">(</span><span class="k">new</span> <span class="n">MenuBarItem</span> <span class="p">[]</span> <span class="p">{</span>
    <span class="k">new</span> <span class="nf">MenuBarItem</span> <span class="p">(</span><span class="s">"_File"</span><span class="p">,</span> <span class="k">new</span> <span class="n">MenuItem</span> <span class="p">[]</span> <span class="p">{</span>
        <span class="k">new</span> <span class="nf">MenuItem</span> <span class="p">(</span><span class="s">"_New"</span><span class="p">,</span> <span class="s">"Creates new file"</span><span class="p">,</span> <span class="p">()=&gt;</span> <span class="p">{}),</span>
        <span class="k">new</span> <span class="nf">MenuItem</span> <span class="p">(</span><span class="s">"_Close"</span><span class="p">,</span> <span class="s">""</span><span class="p">,</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{}),</span>
        <span class="k">new</span> <span class="nf">MenuItem</span> <span class="p">(</span><span class="s">"_Quit"</span><span class="p">,</span> <span class="s">""</span><span class="p">,</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span> <span class="n">top</span><span class="p">.</span><span class="n">Running</span> <span class="p">=</span> <span class="k">false</span><span class="p">;</span> <span class="p">})</span>
    <span class="p">}),</span>
    <span class="k">new</span> <span class="nf">MenuBarItem</span> <span class="p">(</span><span class="s">"_Edit"</span><span class="p">,</span> <span class="k">new</span> <span class="n">MenuItem</span> <span class="p">[]</span> <span class="p">{</span>
        <span class="k">new</span> <span class="nf">MenuItem</span> <span class="p">(</span><span class="s">"_Copy"</span><span class="p">,</span> <span class="s">""</span><span class="p">,</span> <span class="k">null</span><span class="p">),</span>
        <span class="k">new</span> <span class="nf">MenuItem</span> <span class="p">(</span><span class="s">"C_ut"</span><span class="p">,</span> <span class="s">""</span><span class="p">,</span> <span class="k">null</span><span class="p">),</span>
        <span class="k">new</span> <span class="nf">MenuItem</span> <span class="p">(</span><span class="s">"_Paste"</span><span class="p">,</span> <span class="s">""</span><span class="p">,</span> <span class="k">null</span><span class="p">)</span>
    <span class="p">})</span>
<span class="p">});</span>
<span class="n">top</span><span class="p">.</span><span class="nf">Add</span> <span class="p">(</span><span class="n">menu</span><span class="p">);</span>

<span class="c1">// Add some controls</span>
<span class="n">win</span><span class="p">.</span><span class="nf">Add</span> <span class="p">(</span>
    <span class="k">new</span> <span class="nf">Label</span> <span class="p">(</span><span class="m">3</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="s">"Login: "</span><span class="p">),</span>
    <span class="k">new</span> <span class="nf">TextField</span> <span class="p">(</span><span class="m">14</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="m">40</span><span class="p">,</span> <span class="s">""</span><span class="p">),</span>
    <span class="k">new</span> <span class="nf">Label</span> <span class="p">(</span><span class="m">3</span><span class="p">,</span> <span class="m">4</span><span class="p">,</span> <span class="s">"Password: "</span><span class="p">),</span>
    <span class="k">new</span> <span class="nf">TextField</span> <span class="p">(</span><span class="m">14</span><span class="p">,</span> <span class="m">4</span><span class="p">,</span> <span class="m">40</span><span class="p">,</span> <span class="s">""</span><span class="p">)</span> <span class="p">{</span>  <span class="p">},</span>
    <span class="k">new</span> <span class="nf">CheckBox</span> <span class="p">(</span><span class="m">3</span><span class="p">,</span> <span class="m">6</span><span class="p">,</span> <span class="s">"Remember me"</span><span class="p">),</span>
    <span class="k">new</span> <span class="nf">RadioGroup</span> <span class="p">(</span><span class="m">3</span><span class="p">,</span> <span class="m">8</span><span class="p">,</span> <span class="k">new</span> <span class="p">[]</span> <span class="p">{</span> <span class="s">"_Personal"</span><span class="p">,</span> <span class="s">"_Company"</span> <span class="p">}),</span>
    <span class="k">new</span> <span class="nf">Button</span> <span class="p">(</span><span class="m">3</span><span class="p">,</span> <span class="m">14</span><span class="p">,</span> <span class="s">"Ok"</span><span class="p">),</span>
    <span class="k">new</span> <span class="nf">Button</span> <span class="p">(</span><span class="m">10</span><span class="p">,</span> <span class="m">14</span><span class="p">,</span> <span class="s">"Cancel"</span><span class="p">),</span>
    <span class="k">new</span> <span class="nf">Label</span> <span class="p">(</span><span class="m">3</span><span class="p">,</span> <span class="m">18</span><span class="p">,</span> <span class="s">"Press ESC and 9 to activate the menubar"</span><span class="p">));</span>

<span class="n">Application</span><span class="p">.</span><span class="nf">Run</span> <span class="p">();</span></code></pre></figure>

<p><img src="/public/img/sampleTerminalUI.png" alt="Sample app" width="700" /></p>

<p>You can build even complex console-based UI using this toolkit:</p>

<figure class="highlight"><pre><code class="language-csharp" data-lang="csharp"><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Linq</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">NStack</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Terminal.Gui</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">TestingGuiCS.Models</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">TestingGuiCS</span>
<span class="p">{</span>
    <span class="k">class</span> <span class="nc">Program</span>
    <span class="p">{</span>
        <span class="k">static</span> <span class="k">void</span> <span class="nf">Main</span><span class="p">(</span><span class="kt">string</span><span class="p">[]</span> <span class="n">args</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">Application</span><span class="p">.</span><span class="nf">Init</span> <span class="p">();</span>
            <span class="kt">var</span> <span class="n">top</span> <span class="p">=</span> <span class="n">Application</span><span class="p">.</span><span class="n">Top</span><span class="p">;</span>

            <span class="c1">// Creates a menubar, the item "New" has a help menu.</span>
            <span class="kt">var</span> <span class="n">menu</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">MenuBar</span> <span class="p">(</span><span class="k">new</span> <span class="n">MenuBarItem</span> <span class="p">[]</span> <span class="p">{</span>
                <span class="k">new</span> <span class="nf">MenuBarItem</span> <span class="p">(</span><span class="s">"_File"</span><span class="p">,</span> <span class="k">new</span> <span class="n">MenuItem</span> <span class="p">[]</span> <span class="p">{</span>
                    <span class="k">new</span> <span class="nf">MenuItem</span> <span class="p">(</span><span class="s">"_Quit"</span><span class="p">,</span> <span class="s">""</span><span class="p">,</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span> <span class="n">top</span><span class="p">.</span><span class="n">Running</span> <span class="p">=</span> <span class="k">false</span><span class="p">;</span> <span class="p">})</span>
                <span class="p">})</span>
            <span class="p">});</span>
            <span class="n">top</span><span class="p">.</span><span class="nf">Add</span> <span class="p">(</span><span class="n">menu</span><span class="p">);</span>


            <span class="c1">// Creates the top-level window to show</span>
            <span class="kt">var</span> <span class="n">win</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Window</span> <span class="p">(</span><span class="k">new</span> <span class="nf">Rect</span> <span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="n">top</span><span class="p">.</span><span class="n">Frame</span><span class="p">.</span><span class="n">Width</span><span class="p">,</span> <span class="n">top</span><span class="p">.</span><span class="n">Frame</span><span class="p">.</span><span class="n">Height</span><span class="p">-</span><span class="m">1</span><span class="p">),</span> <span class="s">"Movie Db"</span><span class="p">);</span>
            <span class="n">top</span><span class="p">.</span><span class="nf">Add</span> <span class="p">(</span><span class="n">win</span><span class="p">);</span>

            <span class="c1">// Add some controls</span>
            <span class="kt">var</span> <span class="n">txtSearchLbl</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Label</span><span class="p">(</span><span class="m">3</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="s">"Movie Name: "</span><span class="p">);</span>
            <span class="kt">var</span> <span class="n">txtSearch</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">TextField</span><span class="p">(</span><span class="m">15</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">30</span><span class="p">,</span> <span class="s">""</span><span class="p">);</span>
            <span class="kt">var</span> <span class="n">forKidsOnly</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">CheckBox</span><span class="p">(</span><span class="m">3</span><span class="p">,</span> <span class="m">3</span><span class="p">,</span> <span class="s">"For Kids?"</span><span class="p">);</span>
            <span class="kt">var</span> <span class="n">minimumRatingLbl</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Label</span><span class="p">(</span><span class="m">25</span><span class="p">,</span> <span class="m">3</span><span class="p">,</span> <span class="s">"Minimum Rating: "</span><span class="p">);</span>
            <span class="kt">var</span> <span class="n">minimumRatingTxt</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">TextField</span><span class="p">(</span><span class="m">41</span><span class="p">,</span> <span class="m">3</span><span class="p">,</span> <span class="m">10</span><span class="p">,</span> <span class="s">""</span><span class="p">);</span>
            <span class="kt">var</span> <span class="n">searchBtn</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Button</span><span class="p">(</span><span class="m">3</span><span class="p">,</span> <span class="m">5</span><span class="p">,</span> <span class="s">"Filter"</span><span class="p">);</span>
            <span class="kt">var</span> <span class="n">allMoviesListView</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">ListView</span><span class="p">(</span><span class="k">new</span> <span class="nf">Rect</span><span class="p">(</span><span class="m">4</span><span class="p">,</span> <span class="m">8</span><span class="p">,</span> <span class="n">top</span><span class="p">.</span><span class="n">Frame</span><span class="p">.</span><span class="n">Width</span><span class="p">,</span> <span class="m">200</span><span class="p">),</span> <span class="n">MovieDataSource</span><span class="p">.</span><span class="nf">GetList</span><span class="p">(</span><span class="n">forKidsOnly</span><span class="p">.</span><span class="n">Checked</span><span class="p">,</span> <span class="m">0</span><span class="p">).</span><span class="nf">ToList</span><span class="p">());</span>
            <span class="n">searchBtn</span><span class="p">.</span><span class="n">Clicked</span> <span class="p">=</span> <span class="p">()</span> <span class="p">=&gt;</span>
            <span class="p">{</span>

                <span class="kt">double</span> <span class="n">rating</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span>
                <span class="kt">var</span> <span class="n">isDouble</span> <span class="p">=</span> <span class="kt">double</span><span class="p">.</span><span class="nf">TryParse</span><span class="p">(</span><span class="n">minimumRatingTxt</span><span class="p">.</span><span class="n">Text</span><span class="p">.</span><span class="nf">ToString</span><span class="p">(),</span> <span class="k">out</span> <span class="n">rating</span><span class="p">);</span>
                <span class="k">if</span><span class="p">(!</span><span class="kt">string</span><span class="p">.</span><span class="nf">IsNullOrEmpty</span><span class="p">(</span><span class="n">minimumRatingTxt</span><span class="p">.</span><span class="n">Text</span><span class="p">.</span><span class="nf">ToString</span><span class="p">())</span> <span class="p">&amp;&amp;</span> <span class="p">!</span><span class="n">isDouble</span><span class="p">)</span>
                <span class="p">{</span>
                    <span class="n">MessageBox</span><span class="p">.</span><span class="nf">ErrorQuery</span><span class="p">(</span><span class="m">30</span><span class="p">,</span> <span class="m">6</span><span class="p">,</span> <span class="s">"Error"</span><span class="p">,</span> <span class="s">"Rating must be number"</span><span class="p">);</span>
                    <span class="n">minimumRatingTxt</span><span class="p">.</span><span class="n">Text</span> <span class="p">=</span> <span class="n">ustring</span><span class="p">.</span><span class="n">Empty</span><span class="p">;</span>
                    <span class="k">return</span><span class="p">;</span>
                <span class="p">}</span>

                <span class="n">win</span><span class="p">.</span><span class="nf">Remove</span><span class="p">(</span><span class="n">allMoviesListView</span><span class="p">);</span>
                <span class="k">if</span> <span class="p">(</span><span class="kt">string</span><span class="p">.</span><span class="nf">IsNullOrEmpty</span><span class="p">(</span><span class="n">txtSearch</span><span class="p">.</span><span class="n">Text</span><span class="p">.</span><span class="nf">ToString</span><span class="p">())</span> <span class="p">||</span> <span class="kt">string</span><span class="p">.</span><span class="nf">IsNullOrEmpty</span><span class="p">(</span><span class="n">minimumRatingTxt</span><span class="p">.</span><span class="n">Text</span><span class="p">.</span><span class="nf">ToString</span><span class="p">()))</span>
                <span class="p">{</span>
                    <span class="n">allMoviesListView</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">ListView</span><span class="p">(</span><span class="k">new</span> <span class="nf">Rect</span><span class="p">(</span><span class="m">4</span><span class="p">,</span> <span class="m">8</span><span class="p">,</span> <span class="n">top</span><span class="p">.</span><span class="n">Frame</span><span class="p">.</span><span class="n">Width</span><span class="p">,</span> <span class="m">200</span><span class="p">),</span>
                        <span class="n">MovieDataSource</span><span class="p">.</span><span class="nf">GetList</span><span class="p">(</span><span class="n">forKidsOnly</span><span class="p">.</span><span class="n">Checked</span><span class="p">,</span> <span class="n">rating</span><span class="p">).</span><span class="nf">ToList</span><span class="p">());</span>
                    <span class="n">win</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="n">allMoviesListView</span><span class="p">);</span>
                <span class="p">}</span>
                <span class="k">else</span>
                <span class="p">{</span>
                    <span class="n">win</span><span class="p">.</span><span class="nf">Remove</span><span class="p">(</span><span class="n">allMoviesListView</span><span class="p">);</span>
                    <span class="n">win</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="k">new</span> <span class="nf">ListView</span><span class="p">(</span><span class="k">new</span> <span class="nf">Rect</span><span class="p">(</span><span class="m">4</span><span class="p">,</span> <span class="m">8</span><span class="p">,</span> <span class="n">top</span><span class="p">.</span><span class="n">Frame</span><span class="p">.</span><span class="n">Width</span><span class="p">,</span> <span class="m">200</span><span class="p">),</span>
                        <span class="n">MovieDataSource</span><span class="p">.</span><span class="nf">GetList</span><span class="p">(</span><span class="n">forKidsOnly</span><span class="p">.</span><span class="n">Checked</span><span class="p">,</span> <span class="n">rating</span><span class="p">)</span>
                            <span class="p">.</span><span class="nf">Where</span><span class="p">(</span><span class="n">x</span> <span class="p">=&gt;</span>
                            <span class="n">x</span><span class="p">.</span><span class="n">Name</span><span class="p">.</span><span class="nf">Contains</span><span class="p">(</span><span class="n">txtSearch</span><span class="p">.</span><span class="n">Text</span><span class="p">.</span><span class="nf">ToString</span><span class="p">(),</span> <span class="n">StringComparison</span><span class="p">.</span><span class="n">OrdinalIgnoreCase</span><span class="p">)</span>
                        <span class="p">).</span><span class="nf">ToList</span><span class="p">()));</span>
                <span class="p">}</span>

            <span class="p">};</span>
            <span class="n">win</span><span class="p">.</span><span class="nf">Add</span> <span class="p">(</span>
                <span class="n">txtSearchLbl</span><span class="p">,</span>
                <span class="n">txtSearch</span><span class="p">,</span>
                <span class="n">forKidsOnly</span><span class="p">,</span>
                <span class="n">minimumRatingLbl</span><span class="p">,</span>
                <span class="n">minimumRatingTxt</span><span class="p">,</span>
                <span class="n">searchBtn</span><span class="p">,</span>
                <span class="k">new</span> <span class="nf">Label</span> <span class="p">(</span><span class="m">3</span><span class="p">,</span> <span class="m">7</span><span class="p">,</span> <span class="s">"-------------Search Result--------------"</span><span class="p">)</span>
            <span class="p">);</span>

            <span class="n">Application</span><span class="p">.</span><span class="nf">Run</span> <span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre></figure>

<p><img src="/public/img/terminalUI.gif" alt="Sample app" width="700" /></p>

<p>You can grab the working sample project from <a href="https://github.com/SirwanAfifi/Console-based-UI">GitHub</a>.</p>

<h3 id="what-about-cross-platform-ui-frameworks">What about cross platform UI frameworks?</h3>
<p>Developing cross platform UIs is not officially supported by Microsoft, But there are some open source projects out there for doing so:</p>
<ul>
  <li><a href="https://github.com/AvaloniaUI/Avalonia">Avalonia</a></li>
  <li><a href="https://github.com/picoe/Eto">Eto.Forms</a></li>
</ul>


  </div>
  
</div>


<div class="pagination">
  
    <a href="/">&laquo; Prev</a>
  

  
    <a href="/page/3">Next &raquo;</a>
  
</div>

  </div>
  <footer id="footer" class="inner"><div class="container">
  <div class="row">
    <div class="col-md-12">
      <p>
        Copyright &copy; 2018 - Sirwan Afifi | Site design based on the <a href="http://hyde.getpoole.com/">Hyde theme</a>
      </p>
    </div>
  </div>
</div></footer>
</body>

</html>